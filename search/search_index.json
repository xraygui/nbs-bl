{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"NSLS-II Beamline Support Library","text":"<p>The NSLS-II Beamline Support Library (nbs-bl) provides core functionality for beamline operation and control at NSLS-II. It includes:</p> <ul> <li>Beamline configuration management</li> <li>Device control and monitoring</li> <li>Scan plans and utilities</li> <li>Simulation capabilities</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":"<p>To install nbs-bl:</p> <pre><code>pip install -e .\n</code></pre>"},{"location":"#configuration","title":"Configuration","text":"<p>The library uses TOML configuration files to define beamline devices and settings:</p> <ul> <li>Configuration Reference - Detailed guide to configuring your beamline</li> <li>Beamline Template - Template for beamline.toml</li> <li>Devices Template - Template for devices.toml</li> </ul>"},{"location":"#development","title":"Development","text":"<p>This project is part of the xraygui organization on GitHub. </p>"},{"location":"configuration_reference/","title":"Beamline Configuration Reference","text":""},{"location":"configuration_reference/#overview","title":"Overview","text":"<p>The beamline configuration system uses TOML files to define the hardware, settings, and behavior of a beamline. The configuration is split into two main files: - <code>beamline.toml</code>: Core beamline settings and capabilities - <code>devices.toml</code>: Hardware device definitions and properties</p>"},{"location":"configuration_reference/#beamlinetoml-reference","title":"beamline.toml Reference","text":""},{"location":"configuration_reference/#configuration-section","title":"Configuration Section","text":"<pre><code>[configuration]\n# List of devices to include in baseline readings\nbaseline = [\"motor1\", \"detector1\"]\n\n# Core beamline capabilities\nhas_slits = true          # Whether beamline has slit devices\nhas_motorized_samples = true    # Whether beamline has motorized sample stages\nhas_motorized_eref = false     # Whether beamline has motorized energy reference\nhas_polarization = false       # Whether beamline has polarization control\n</code></pre>"},{"location":"configuration_reference/#detector-sets","title":"Detector Sets","text":"<p>Define groups of detectors that are commonly used together. <pre><code>[detector_sets.default]\nprimary = \"main_detector\"        # Primary detector for measurements\nnormalization = \"i0\"            # Detector used for normalization\nreference = \"ir\"                # Reference detector\n\n[detector_sets.transmission]\nprimary = \"it\"\nnormalization = \"i0\"\nreference = \"ir\"\n</code></pre></p>"},{"location":"configuration_reference/#settings","title":"Settings","text":"<p>General beamline settings and module configuration. <pre><code>[settings]\n# Python modules to load at startup\nmodules = [\"haxpes.startup\", \"rsoxs.startup\"]\n\n# Plan-specific settings\n[settings.plans]\nscan_plans = [\"plans/xas.toml\", \"plans/xps.toml\"]\nalignment = [\"plans/alignment.toml\"]\n\n# Redis metadata configuration\n[settings.redis.md]\nhost = \"redis\"\nprefix = \"beamline_name\"\n\n# Redis info configuration\n[settings.redis.info]\nhost = \"redisInfo\"\nprefix = \"\"\nport = 60737\ndb = 4\n</code></pre></p>"},{"location":"configuration_reference/#devicestoml-reference","title":"devices.toml Reference","text":""},{"location":"configuration_reference/#device-configuration-format","title":"Device Configuration Format","text":"<p>Each device entry follows this general structure: <pre><code>[device_name]\n# Required fields\n_target = \"package.module.DeviceClass\"  # Python class to instantiate\nname = \"human_readable_name\"            # Display name\nprefix = \"PV:PREFIX:\"                   # EPICS PV prefix\n\n# Optional fields\n_defer_loading = false                  # Whether to defer device loading\n_add_to_ns = true                       # Add to IPython namespace\ndescription = \"Device description\"      # Human-readable description\n\n# Group membership\ngroups = [\"motors\", \"detectors\"]        # Device groups\nroles = [\"primary_detector\"]            # Device roles\n\n# Device-specific parameters\nparam1 = value1\nparam2 = value2\n</code></pre></p>"},{"location":"configuration_reference/#common-device-types","title":"Common Device Types","text":""},{"location":"configuration_reference/#motors","title":"Motors","text":"<pre><code>[sample_x]\n_target = \"nbs_bl.devices.motors.DeadbandEpicsMotor\"\nname = \"Sample X\"\nprefix = \"MOTOR:X:\"\ngroups = [\"motors\", \"sample_motors\"]\ntolerance = 0.1\nbaseline = true\n</code></pre>"},{"location":"configuration_reference/#detectors","title":"Detectors","text":"<pre><code>[main_detector]\n_target = \"nbs_bl.devices.detectors.ophScalar\"\nname = \"Main Detector\"\nprefix = \"DET:MAIN:\"\ngroups = [\"detectors\"]\nroles = [\"primary\"]\ndescription = \"Main measurement detector\"\nrescale = 1.0\n</code></pre>"},{"location":"configuration_reference/#sample-holders","title":"Sample Holders","text":"<pre><code>[sample_holder]\n_target = \"nbs_bl.devices.sampleholders.Manipulator4AxBase\"\nname = \"Sample Manipulator\"\nprefix = \"MANIP:\"\nattachment_point = [0, 0, 0]\nbeam_direction = [0, -1, 0]\nrotation_ax = 2\ngroups = [\"manipulators\"]\n</code></pre>"},{"location":"configuration_reference/#shutters","title":"Shutters","text":"<pre><code>[photon_shutter]\n_target = \"nbs_bl.devices.shutters.EPS_Shutter\"\nname = \"Photon Shutter\"\nprefix = \"PS:\"\ngroups = [\"shutters\"]\nopenval = 1\ncloseval = 0\n</code></pre>"},{"location":"configuration_reference/#best-practices","title":"Best Practices","text":""},{"location":"configuration_reference/#device-organization","title":"Device Organization","text":"<ol> <li>Group related devices together in the configuration</li> <li>Use consistent naming conventions:</li> <li>Lowercase with underscores for device keys</li> <li>Descriptive human-readable names</li> <li>Clear, consistent PV prefixes</li> <li>Document special requirements or dependencies</li> </ol>"},{"location":"configuration_reference/#deferred-loading","title":"Deferred Loading","text":"<p>Use <code>_defer_loading = true</code> for devices that: - Are not always available - Have long initialization times - Are only needed for specific operations - May conflict with other devices</p>"},{"location":"configuration_reference/#device-groups","title":"Device Groups","text":"<p>Standard group names include: - <code>motors</code>: All motor devices - <code>detectors</code>: All detector devices - <code>shutters</code>: Beam and safety shutters - <code>gauges</code>: Vacuum gauges - <code>manipulators</code>: Sample manipulation devices - <code>mirrors</code>: Beamline optics - <code>slits</code>: Beam-defining slits</p>"},{"location":"configuration_reference/#device-roles","title":"Device Roles","text":"<p>Common roles include: - <code>beam_current</code>: Storage ring current measurement - <code>beam_status</code>: Beam availability status - <code>default_shutter</code>: Primary photon shutter - <code>energy</code>: Monochromator or energy setting device - <code>intensity_detector</code>: Primary intensity measurement - <code>primary_sampleholder</code>: Main sample manipulation stage - <code>reference_sampleholder</code>: Reference sample stage - <code>slits</code>: Primary beam-defining slits</p>"},{"location":"configuration_reference/#redis-configuration","title":"Redis Configuration","text":"<ol> <li>Use separate configurations for metadata and info</li> <li>Choose meaningful prefixes to avoid conflicts</li> <li>Document required Redis setup and connectivity</li> </ol>"},{"location":"configuration_reference/#configuration-validation","title":"Configuration Validation","text":"<p>Before deploying a new configuration: 1. Verify all required fields are present 2. Check PV connectivity 3. Test device initialization 4. Validate group and role assignments 5. Ensure Redis connectivity 6. Test deferred loading behavior</p>"},{"location":"configuration_reference/#common-issues-and-solutions","title":"Common Issues and Solutions","text":""},{"location":"configuration_reference/#device-loading-failures","title":"Device Loading Failures","text":"<ul> <li>Verify PV prefix is correct</li> <li>Check EPICS IOC is running</li> <li>Ensure network connectivity</li> <li>Verify required dependencies are installed</li> </ul>"},{"location":"configuration_reference/#redis-connectivity","title":"Redis Connectivity","text":"<ul> <li>Check Redis server is running</li> <li>Verify port and host settings</li> <li>Ensure network allows Redis connections</li> <li>Check database permissions</li> </ul>"},{"location":"configuration_reference/#group-and-role-conflicts","title":"Group and Role Conflicts","text":"<ul> <li>Verify no duplicate role assignments</li> <li>Check group membership logic</li> <li>Validate device compatibility</li> <li>Test interaction between grouped devices ``` </li> </ul>"}]}